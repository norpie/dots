#!/usr/bin/env bash

# Usage: reload [<supported program>]
# Reloads the specified program with custom logic.

program="$1"

if [[ -z "$program" ]]; then
  echo "Usage: reload <program>"
  exit 1
fi

case "$program" in
  "waybar")
      pkill waybar; hyprctl dispatch exec waybar
    ;;
  "hyprland")
      hyprctl reload
    ;;
  "hyprlock")
      hyprctl --instance 0 'keyword misc:allow_session_lock_restore 1' &&
          hyprctl --instance 0 'dispatch exec hyprlock'
    ;;
  "hyprland-plugins")
      grep '^exec-once=hyprctl plugin load ' ~/.config/hypr/hyprland.conf | \
          sed 's/^exec-once=//' | \
          while read -r cmd; do
              eval "$cmd"
          done
    ;;
  *)
    echo "Unsupported program: $program"
    exit 1
    ;;
esac

echo "$program reloaded successfully."
