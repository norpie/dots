#!/usr/bin/env bash

choices=$(bluetoothctl devices Connected | grep "^Device" | cut -c 8-99)

# Add numbers to choices  
numbered_choices=$(echo "$choices" | awk '{print $2}' | nl -w2 -s'. ')

choice=$(echo "$numbered_choices" | rofi -dmenu -p "Disconnect device")

[[ $choice == "" ]] && exit 1

# Extract just the device name (everything after the number and '. ')
device_name=$(echo "$choice" | sed 's/^[[:space:]]*[0-9]*\.[[:space:]]*//')

bluetoothctl disconnect $(echo "$choices" | grep "$device_name" | cut -c 1-17)